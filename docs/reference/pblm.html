<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phylogenetic Bipartite Linear Model — pblm • picante</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic Bipartite Linear Model — pblm"><meta property="og:description" content="Fits a linear model to the association strengths of a bipartite data set
with or without phylogenetic correlation among the interacting species"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">picante</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phylogenetic Bipartite Linear Model</h1>
    
    <div class="hidden name"><code>pblm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a linear model to the association strengths of a bipartite data set
with or without phylogenetic correlation among the interacting species</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pblm</span><span class="op">(</span></span>
<span>  <span class="va">assocs</span>,</span>
<span>  tree1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tree2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covars1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covars2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nreps <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  pstart <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>assocs</dt>
<dd><p>A matrix of association strengths among two sets of
interacting species</p></dd>


<dt>tree1</dt>
<dd><p>A phylo tree object or a phylogenetic covariance matrix for
the rows of <code>assocs</code></p></dd>


<dt>tree2</dt>
<dd><p>A phylo tree object or a phylogenetic covariance matrix for
the columns of <code>assocs</code></p></dd>


<dt>covars1</dt>
<dd><p>A matrix of covariates (e.g., traits) for the row species of
<code>assocs</code></p></dd>


<dt>covars2</dt>
<dd><p>A matrix of covariates (e.g., traits) for the column species
of <code>assocs</code></p></dd>


<dt>bootstrap</dt>
<dd><p>logical, bootstrap confidence intervals of the parameter
estimates</p></dd>


<dt>nreps</dt>
<dd><p>Number of bootstrap replicated data sets to estimate parameter
CIs</p></dd>


<dt>maxit</dt>
<dd><p>as in <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></dd>


<dt>pstart</dt>
<dd><p>starting values of the two phylogenetic signal strength
parameters passed to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></dd>


<dt>x</dt>
<dd><p>object of class <code>pblm</code></p></dd>


<dt>tree1.w.novel</dt>
<dd><p>A phylo tree object or a phylogenetic covariance
matrix which corresponds to <code>tree1</code> of <code>x</code> with species to
predict associations</p></dd>


<dt>tree2.w.novel</dt>
<dd><p>A phylo tree object or a phylogenetic covariance
matrix which corresponds to <code>tree2</code> of <code>x</code> with species to
predict associations</p></dd>


<dt>predict.originals</dt>
<dd><p>if <code>TRUE</code> then the associations of each
original species in the two phylogenies is predicted</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>MSE</dt>
<dd><p>total, full (each <em>d</em> estimated), star
(<em>d=0</em>), and base (<em>d=1</em>) mean squared errors</p></dd>

<dt>signal.strength</dt>
<dd><p>two estimates of phylogenetic signal strength</p></dd>

<dt>coefficients</dt>
<dd><p>estimated intercept and covariate coefficients with
approximate 95 percent CIs for the three model types (full, star, base)</p></dd>

<dt>CI.boot</dt>
<dd><p>95 percent CIs for all parameters</p></dd>
 <dt>variates</dt>
<dd><p>matrix
of model variates (can be used for plotting)</p></dd>
 <dt>residuals</dt>
<dd><p>matrix of
residuals from the three models (full, star and base)</p></dd>
 <dt>predicted</dt>
<dd><p>predicted associations</p></dd>
 <dt>bootvalues</dt>
<dd><p>matrix of parameters estimated
from the <code>nreps</code> bootstrap replicated data sets used to calculate CIs</p></dd>
 <dt>phylocovs</dt>
<dd><p>phylogenetic covariance matricies scaled by the
estimated <code>d1</code> and <code>d2</code></p></dd>
 <dt>cors.1</dt>
<dd><p>correlations among
predicted and observed associations for species of <code>tree1</code>, <code>NA</code>
if <code>predict.originals=FALSE</code></p></dd>
 <dt>cors.2</dt>
<dd><p>correlations among
predicted and observed associations for species of <code>tree2</code>, <code>NA</code>
if <code>predict.originals=FALSE</code></p></dd>
 <dt>pred.novels1</dt>
<dd><p>predicted
associations for the novel speices of <code>tree1</code></p></dd>
 <dt>pred.novels2</dt>
<dd><p>predicted associations for the novel speices of <code>tree2</code></p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Fit a linear model with covariates using estimated generalized least
squares to the association strengths between two sets of interacting
species.  Associations can be either binary or continuous. If phylogenies
of the two sets of interacting species are supplied, two <em>phyogenetic
signal strength</em> parameters (<em>d1</em> and <em>d2</em>), one for each species
set, based on an Ornstein-Uhlenbeck model of evolution with stabilizing
selection are estimated. Values of <em>d=1</em> indicate no stabilizing
selection and correspond to the Brownian motion model of evolution;
<em>0&lt;d&lt;1</em> represents stabilizing selection; <em>d=0</em> depicts the
absence of phylogenetic correlation (i.e., a star phylogeny); and
<em>d&gt;1</em> corresponds to disruptive selection where phylogenetic signal is
amplified. Confidence intervals for these and the other parameters can be
estimated with bootstrapping.  <br><br> The function <code>pblmpredict</code>
predicts the associations of novel species following the methods given in
appendix B of Ives and Godfray (2006).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Covariates that apply to both species sets (e.g., sampling site)
should be supplied in the covariate matrix of the set with the most
species. <br><br> Bootstrapping CIs is slow due to the function
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> used to estimate the model parameters. See appendix A
in Ives and Godfray (2006) for a discussion about this boostrapping
procedure <br><br> If <code>pblmpredict=TRUE</code> the function does not first
remove each species in turn when predicting the associations of the
original species as is done in Ives and Godfray (2006).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ives A.R. &amp; Godfray H.C. (2006) Phylogenetic analysis of
trophic associations. The American Naturalist, 168, E1-E14 <br><br> Blomberg
S.P., Garland T.J. &amp; Ives A.R. (2003) Testing for phylogenetic signal in
comparative data: Behavioral traits are more labile. Evolution, 57, 717-745</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthew Helmus <a href="mailto:mrhelmus@gmail.com">mrhelmus@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#load example data from Ives &amp; Godfray (2006)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">IvesGodfray</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#net attack rate of parasitoid on host eq.4 in Ives and Godfray</span></span></span>
<span class="r-in"><span><span class="va">A</span><span class="op">&lt;-</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">interactions</span><span class="op">[</span>,<span class="op">-</span><span class="fl">28</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">interactions</span><span class="op">[</span><span class="fl">28</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make tips of the phylogenetic trees contemporaneous by extending tips</span></span></span>
<span class="r-in"><span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">host</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">q</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">parasitoid</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">host.cov.scaled</span><span class="op">&lt;-</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">host</span></span></span>
<span class="r-in"><span><span class="va">para.cov.scaled</span><span class="op">&lt;-</span><span class="va">IvesGodfray</span><span class="op">$</span><span class="va">parasitoid</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">host.cov.scaled</span><span class="op">[</span><span class="va">i</span>,<span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">host.cov.scaled</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">para.cov.scaled</span><span class="op">[</span><span class="va">i</span>,<span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">para.cov.scaled</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scale covariance matrices (this reduces numerical problems caused by</span></span></span>
<span class="r-in"><span><span class="co"># determinants going to infinity or zero)</span></span></span>
<span class="r-in"><span>  <span class="va">host.cov.scaled</span><span class="op">&lt;-</span><span class="va">host.cov.scaled</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">host.cov.scaled</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">para.cov.scaled</span><span class="op">&lt;-</span><span class="va">para.cov.scaled</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">para.cov.scaled</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">q</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pblm.A</span> <span class="op">&lt;-</span> <span class="fu">pblm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,tree1<span class="op">=</span><span class="va">host.cov.scaled</span>,tree2<span class="op">=</span><span class="va">para.cov.scaled</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pblm.A</span><span class="op">$</span><span class="va">signal.strength</span>    <span class="co">#compare to Ives and Godfray (2006) Table 1 Line 1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    booted lower CI 95%     estimate booted upper CI 95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d1                  NA 4.008104e-01                  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d2                  NA 1.637672e-13                  NA</span>
<span class="r-in"><span><span class="va">pblm.A</span><span class="op">$</span><span class="va">MSE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MSETotal     MSEFull    MSEStar    MSEBase</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.01098594 0.009821808 0.01098594 0.01148223</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven W. Kembel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

