<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates Rao's quadratic entropy, a measure of within- and
among-community diversity taking species dissimilarities into account"><title>Rao's quadratic entropy — raoD • picante</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rao's quadratic entropy — raoD"><meta property="og:description" content="Calculates Rao's quadratic entropy, a measure of within- and
among-community diversity taking species dissimilarities into account"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">picante</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/skembel/picante/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rao's quadratic entropy</h1>
      <small class="dont-index">Source: <a href="https://github.com/skembel/picante/blob/HEAD/R/raoD.R" class="external-link"><code>R/raoD.R</code></a></small>
      <div class="d-none name"><code>raoD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates Rao's quadratic entropy, a measure of within- and
among-community diversity taking species dissimilarities into account</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">raoD</span><span class="op">(</span><span class="va">comm</span>, phy <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>comm</dt>
<dd><p>Community data matrix</p></dd>


<dt>phy</dt>
<dd><p>Object of class phylo - an ultrametric phylogenetic tree
(optional)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of results</p>
<dl><dt> Dkk </dt>
<dd><p>Within-community diversity</p></dd>
 <dt>
Dkl </dt>
<dd><p>Among-community diversity</p></dd>
 <dt> H </dt>
<dd><p>Among-community diversities
excluding within-community diversity</p></dd>
 <dt> total </dt>
<dd><p>Total diversity
across all samples</p></dd>
 <dt> alpha </dt>
<dd><p>Alpha diversity - average
within-community diversity</p></dd>
 <dt> beta </dt>
<dd><p>Beta diversity - average
among-community diversity</p></dd>
 <dt> Fst </dt>
<dd><p>Beta diversity / total diversity</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Rao's quadratic entropy (Rao 1982) is a measure of diversity in ecological
communities that can optionally take species differences (e.g. phylogenetic
dissimilarity) into account. This method is conceptually similar to
analyses of genetic diversity among populations (Nei 1973), but instead of
diversity of alleles among populations, it measures diversity of species
among communities.</p>
<p>If no phylogeny is supplied, Dkk is equivalent to Simpson's diversity
(probability that two individuals drawn from a community are from different
taxa), Dkl is a beta-diversity equivalent of Simpson's diversity
(probability that individuals drawn from each of two communities belong to
different taxa), and H is Dkl standardized to account for within-community
diversity.</p>
<p>If an ultrametric phylogeny is supplied, Dkk is equivalent to the mean
pairwise phylogenetic distance (distance to MRCA) between two individuals
drawn from a community, Dkl is the mean pairwise phylogenetic distance
between individuals drawn from each of two communities, and H is Dkl
standardized to account for within-community diversity.</p>
<p>$$Dkl = sum(tij * xki * xli)$$</p>
<p>where <em>xki</em> is the relative abundance of taxon <em>i</em> in community
<em>k</em> and <em>tij</em> is a matrix of weights for all pairs of taxa
<em>i,j</em>. Without a phylogeny, when <em>i=j</em>, <em>tij=0</em>, otherwise
<em>tij=1</em>. With a phylogeny, <em>tij</em> is the phylogenetic distance
to MRCA for taxa <em>i,j</em>.</p>
<p>$$Hkl = Dkl-(Dkk + Dll)/2$$</p>
<p>Alpha, beta and total measure the average diversity within, among, and
across all communities based on Dkk and H values taking variation in number
of individuals per community into account. A Fst-like measure is calculated
by dividing beta by the total diversity across all samples.</p>
    </div>
    <div class="section level2">
    <h2 id="warning-">Warning <a class="anchor" aria-label="anchor" href="#warning-"></a></h2>
    <p>Alpha, beta, and total diversity components and Fst
should not be interpreted as a measure of relative differentiation among
versus within communities. See Jost (2007) for a detailed description of
this problem. Hardy and Jost (2008) suggest Fst can be interpreted as
'local species identity excess' or 'local phylogenetic similarity excess'
rather than as a measure of among-community differentiation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hardy, O.J., and Jost. L. 2008. Interpreting and estimating
measures of community phylogenetic structuring. J. Ecol. 96:849-852.</p>
<p>Jost, L. 2007. Partitioning diversity into independent alpha and beta
components. Ecology 88: 24272439.</p>
<p>Nei, M. 1973. Analysis of gene diversity in sub-divided populations.
Proceedings of the National Academy of Sciences of the USA 70:3321-3323.</p>
<p>Rao, C.R. 1982. Diversity and dissimilarity coefficients: a unified
approach. Theoretical Population Biology 21:2443.</p>
<p>Webb, C.O., Ackerly, D.D., and Kembel, S.W. 2008. Phylocom: software for
the analysis of phylogenetic community structure and trait evolution.
Version 4.0.1. <a href="http://www.phylodiversity.net/phylocom/" class="external-link">http://www.phylodiversity.net/phylocom/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mpd.html">mpd</a></code>, <code><a href="comdist.html">comdist</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Steven Kembel <a href="mailto:steve.kembel@gmail.com">steve.kembel@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">phylocom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">raoD</span><span class="op">(</span><span class="va">phylocom</span><span class="op">$</span><span class="va">sample</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dkk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    clump1   clump2a   clump2b    clump4      even    random </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8750000 0.8611111 0.8611111 0.8611111 0.8750000 0.8437500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dkl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            clump1   clump2a   clump2b    clump4      even    random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump1  0.8750000 0.9583333 0.9583333 0.9791667 0.9687500 0.9765625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2a 0.9583333 0.8611111 0.9722222 0.9583333 0.9687500 0.9843750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2b 0.9583333 0.9722222 0.8611111 0.9305556 0.9687500 0.9635417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump4  0.9791667 0.9583333 0.9305556 0.8611111 0.9375000 0.9635417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> even    0.9687500 0.9687500 0.9687500 0.9375000 0.8750000 0.9609375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random  0.9765625 0.9843750 0.9635417 0.9635417 0.9609375 0.8437500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             clump1    clump2a    clump2b     clump4       even    random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump1  0.00000000 0.09027778 0.09027778 0.11111111 0.09375000 0.1171875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2a 0.09027778 0.00000000 0.11111111 0.09722222 0.10069444 0.1319444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2b 0.09027778 0.11111111 0.00000000 0.06944444 0.10069444 0.1111111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump4  0.11111111 0.09722222 0.06944444 0.00000000 0.06944444 0.1111111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> even    0.09375000 0.10069444 0.10069444 0.06944444 0.00000000 0.1015625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random  0.11718750 0.13194444 0.11111111 0.11111111 0.10156250 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9450692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8602941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08477509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fst</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08970252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">raoD</span><span class="op">(</span><span class="va">phylocom</span><span class="op">$</span><span class="va">sample</span>, <span class="va">phylocom</span><span class="op">$</span><span class="va">phylo</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Dropping tips from the tree\n     because they are not present in the community data:"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sp16" "sp23" "sp27" "sp28" "sp30" "sp31" "sp32"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dkk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clump1  clump2a  clump2b   clump4     even   random </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.125000 2.472222 2.916667 3.472222 3.875000 3.554688 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Dkl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           clump1  clump2a  clump2b   clump4    even   random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump1  2.125000 3.375000 4.041667 4.354167 4.03125 4.023438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2a 3.375000 2.472222 4.361111 4.208333 4.03125 3.911458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2b 4.041667 4.361111 2.916667 3.680556 4.03125 3.973958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump4  4.354167 4.208333 3.680556 3.472222 3.93750 4.119792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> even    4.031250 4.031250 4.031250 3.937500 3.87500 4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random  4.023438 3.911458 3.973958 4.119792 4.00000 3.554688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $H</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           clump1   clump2a   clump2b    clump4      even    random</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump1  0.000000 1.0763889 1.5208333 1.5555556 1.0312500 1.1835938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2a 1.076389 0.0000000 1.6666667 1.2361111 0.8576389 0.8980035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump2b 1.520833 1.6666667 0.0000000 0.4861111 0.6354167 0.7382812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clump4  1.555556 1.2361111 0.4861111 0.0000000 0.2638889 0.6063368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> even    1.031250 0.8576389 0.6354167 0.2638889 0.0000000 0.2851562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random  1.183594 0.8980035 0.7382812 0.6063368 0.2851562 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.858564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.106005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7525591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Fst</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1950361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Steven W. Kembel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

